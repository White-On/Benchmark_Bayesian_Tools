from pandas import read_csv
from pgmpy.estimators import ExhaustiveSearch, BicScore
import os
import sys

currentdir = os.path.dirname(os.path.realpath(__file__))

# Read the data from the file
samples = read_csv(f"{currentdir}/data/sample_{sys.argv[1]}_alarm.csv", sep=",")

# estimate structure
est = ExhaustiveSearch(samples, scoring_method=BicScore(samples))
best_model = est.estimate()

# Save the model
best_model.to_bif(f"{currentdir}/data/pgmpy_learned_{sys.argv[1]}_alarm.bif")